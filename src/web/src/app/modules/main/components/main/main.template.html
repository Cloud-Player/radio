<section class="ui">
  <div class="player">
    <label [ngClass]="{'open': socketStatus==='SOCKET_OPEN'}">
      Socket Url
      ws://<input type="url" [(ngModel)]="socketUrl" (ngModelChange)="stopRetry()">
      <button *ngIf="socketStatus==='SOCKET_WAITING'"
              (click)="openSocket()">Connect
      </button>
      <button *ngIf="socketStatus==='SOCKET_OPEN_RETRY'"
              (click)="stopRetry()">Stop Retry
      </button>
      {{socketStatus}}
      <span *ngIf="socketStatus==='SOCKET_OPEN_RETRY'">(in {{socketRetryProgress/1000}}s)</span>
    </label>
    <hr>
    <div class="player-holder">
      <div class="players" [hidden]="!showPlayer">
        <app-player-manager
          [playQueue]="playQueue"
          [volume]="playerVolume">
        </app-player-manager>
        <app-player-manager
          [playQueue]="noiseQueue"
          [volume]="noiseVolume"
          hidden>
        </app-player-manager>
      </div>
      <div class="playqueue">
        <b>Playqueue</b>
        <ul *ngIf="playQueue.length>0">
          <li *ngFor="let item of playQueue.models">
            <span *ngIf="item.isPlaying()">â–¶</span>
            {{item.track.id}}
            <span *ngIf="item.track.title">- {{item.track.title}}</span>
            - {{item.track.provider}}
            <span *ngIf="item.duration && item.progress">{{item.progress/item.duration}}%</span>
          </li>
        </ul>
        <ul *ngIf="playQueue.length===0">
          <li>No items are in the playqueue</li>
        </ul>
      </div>
    </div>
    <br>
    <div>
      <label>
        Show Player
        <input type="checkbox" [(ngModel)]="showPlayer">
      </label>
    </div>
    <hr>
    <app-socket-mock-controls
      [playQueue]="playQueue"
      [volume]="volume"
      [noise]="noise"
      [isLoading]="isLoading">
    </app-socket-mock-controls>
  </div>

  <div class="log">
    <ul>
      <li *ngFor="let logMessage of messages.models">
        <span *ngIf="logMessage.isIncoming()">-->IN</span>
        <span *ngIf="logMessage.isOutgoing()"><--OUT</span>
        {{logMessage.type}}
        {{logMessage.timestamp}}
        <pre>
          {{logMessage.message}}
        </pre>
      </li>
    </ul>
  </div>
</section>
